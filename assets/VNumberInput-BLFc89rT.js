import{f as q,g as me,p as fe,v as pe,bG as ge,c as h,s as O,a4 as be,r as Ne,d as R,w as G,y as A,o as we,E as he,aB as J,R as x,S as g,Y as B,U as xe,an as ee,T as ne,aG as Pe,H as De,bK as Ve,Q as L,bZ as Ie,b_ as Se}from"./index-C-Wof5fh.js";import{V as M}from"./VDivider-DMSXzlXu.js";const Fe=50,ye=500;function Ee(n){let{toggleUpDown:_}=n,i=-1,w=-1;q(c);function y(r){c(),V(r),window.addEventListener("pointerup",c),document.addEventListener("blur",c),i=window.setTimeout(()=>{w=window.setInterval(()=>V(r),Fe)},ye)}function c(){window.clearTimeout(i),window.clearInterval(w),window.removeEventListener("pointerup",c),document.removeEventListener("blur",c)}q(c);function V(r){_(r==="up")}return{holdStart:y,holdStop:c}}const Te=fe({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...De(Ve(),["modelValue","validationValue"])},"VNumberInput"),Re=me()({name:"VNumberInput",props:{...Te()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,_){let{slots:i}=_;const w=pe(),{holdStart:y,holdStop:c}=Ee({toggleUpDown:z}),V=ge(n),r=h(()=>V.isDisabled.value||V.isReadonly.value),E=O(n.focused),{decimalSeparator:te}=be(),l=h(()=>n.decimalSeparator?.[0]||te.value);function P(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const v=t==null?String(e):e.toFixed(t);if(E.value&&d)return Number(v).toString().replace(".",l.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return v.replace(".",l.value);let[D,s]=v.split(".");return s=(s??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0+$`,"g"),""),[D,s].filter(Boolean).join(l.value)}const a=Ne(n,"modelValue",null,e=>e??null,e=>e==null?e??null:R(Number(e),n.min,n.max)),b=O(null),I=O(null);G(a,e=>{E.value&&!r.value&&Number(b.value?.replace(l.value,"."))===e||(e==null?(b.value=null,I.value=null):isNaN(e)||(b.value=P(e),I.value=Number(b.value.replace(l.value,"."))))},{immediate:!0});const u=h({get:()=>b.value,set(e){if(e===null||e===""){a.value=null,b.value=null,I.value=null;return}const t=Number(e.replace(l.value,"."));isNaN(t)||(b.value=e,I.value=t,t<=n.max&&t>=n.min&&(a.value=t))}}),ae=h(()=>{if(I.value===null)return!1;const e=Number(b.value?.replace(l.value,"."));return e!==R(e,n.min,n.max)}),$=h(()=>r.value?!1:(a.value??0)+n.step<=n.max),U=h(()=>r.value?!1:(a.value??0)-n.step>=n.min),o=h(()=>n.hideInput?"stacked":n.controlVariant),K=A(()=>o.value==="split"?"$plus":"$collapse"),Y=A(()=>o.value==="split"?"$minus":"$expand"),T=A(()=>o.value==="split"?"default":"small"),C=A(()=>o.value==="stacked"?"auto":"100%"),le={props:{onClick:k,onPointerup:N,onPointerdown:j,onPointercancel:N}},ue={props:{onClick:k,onPointerup:N,onPointerdown:Q,onPointercancel:N}};G(()=>n.precision,()=>W()),G(()=>n.minFractionDigits,()=>W()),we(()=>{H()});function Z(e){if(e==null)return 0;const t=e.toString(),d=t.indexOf(".");return~d?t.length-d:0}function z(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r.value)return;if(a.value==null){u.value=P(R(0,n.min,n.max));return}let t=Math.max(Z(a.value),Z(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?$.value&&(u.value=P(a.value+n.step,t)):U.value&&(u.value=P(a.value-n.step,t))}function ie(e){if(!e.data)return;const t=e.target,{value:d,selectionStart:v,selectionEnd:D}=t??{},s=d?d.slice(0,v)+e.data+d.slice(D):e.data,m=Ie(s,n.precision,l.value);if(new RegExp(`^-?\\d*${Se(l.value)}?\\d*$`).test(s)||(e.preventDefault(),t.value=m,L(()=>u.value=m)),n.precision!=null){if(s.split(l.value)[1]?.length>n.precision){e.preventDefault(),t.value=m,L(()=>u.value=m);const S=(v??0)+e.data.length;t.setSelectionRange(S,S)}n.precision===0&&s.endsWith(l.value)&&(e.preventDefault(),t.value=m,L(()=>u.value=m))}}async function re(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),H(),await L(),e.key==="ArrowDown"?z(!1):z())}function k(e){e.stopPropagation()}function N(e){e.currentTarget?.releasePointerCapture(e.pointerId),e.preventDefault(),c()}function j(e){e.currentTarget?.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),y("up")}function Q(e){e.currentTarget?.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),y("down")}function H(){if(r.value||!w.value)return;const e=w.value.value,t=Number(e.replace(l.value,"."));e&&!isNaN(t)?u.value=P(R(t,n.min,n.max)):u.value=null}function W(){r.value||(u.value=a.value!==null&&!isNaN(a.value)?P(a.value,n.precision,!1):null)}function oe(){if(!r.value){if(a.value===null||isNaN(a.value)){u.value=null;return}u.value=a.value.toString().replace(".",l.value)}}function se(){oe()}function ce(){H()}return he(()=>{const{modelValue:e,type:t,...d}=J.filterProps(n);function v(){return i.increment?g(ne,{key:"increment-defaults",defaults:{VBtn:{disabled:!$.value,height:C.value,size:T.value,icon:K.value,variant:"text"}}},{default:()=>[i.increment(le)]}):g(ee,{"aria-hidden":"true","data-testid":"increment",disabled:!$.value,height:C.value,icon:K.value,key:"increment-btn",onClick:k,onPointerdown:j,onPointerup:N,onPointercancel:N,size:T.value,variant:"text",tabindex:"-1"},null)}function D(){return i.decrement?g(ne,{key:"decrement-defaults",defaults:{VBtn:{disabled:!U.value,height:C.value,size:T.value,icon:Y.value,variant:"text"}}},{default:()=>[i.decrement(ue)]}):g(ee,{"aria-hidden":"true","data-testid":"decrement",disabled:!U.value,height:C.value,icon:Y.value,key:"decrement-btn",onClick:k,onPointerdown:Q,onPointerup:N,onPointercancel:N,size:T.value,variant:"text",tabindex:"-1"},null)}function s(){return x("div",{class:"v-number-input__control"},[D(),g(M,{vertical:o.value!=="stacked"},null),v()])}function m(){return!n.hideInput&&!n.inset?g(M,{vertical:!0},null):void 0}const S=o.value==="split"?x("div",{class:"v-number-input__control"},[g(M,{vertical:!0},null),v()]):n.reverse||o.value==="hidden"?void 0:x(B,null,[m(),s()]),de=i["append-inner"]||S,X=o.value==="split"?x("div",{class:"v-number-input__control"},[D(),g(M,{vertical:!0},null)]):n.reverse&&o.value!=="hidden"?x(B,null,[s(),m()]):void 0,ve=i["prepend-inner"]||X;return g(J,xe({ref:w},d,{modelValue:u.value,"onUpdate:modelValue":f=>u.value=f,focused:E.value,"onUpdate:focused":f=>E.value=f,validationValue:a.value,error:n.error||ae.value||void 0,onBeforeinput:ie,onFocus:se,onBlur:ce,onKeydown:re,class:["v-number-input",{"v-number-input--default":o.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":o.value==="split","v-number-input--stacked":o.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...i,"append-inner":de?function(){for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return x(B,null,[i["append-inner"]?.(...F),S])}:void 0,"prepend-inner":ve?function(){for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return x(B,null,[X,i["prepend-inner"]?.(...F)])}:void 0})}),Pe({},w)}});export{Re as V};
