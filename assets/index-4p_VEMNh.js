import{p as A,c as V,at as B,g as re,r as oe,y as D,E as se,S as a,ae as ne,R as le,au as ue,ar as ie,as as ce,ab as de,G as me,N as pe,av as ge,ai as O,Z as fe,aj as ve,a0 as ye,ak as b,a1 as P,$ as o,V as Pe,aw as Ve,am as k,ao as x,ax as ke,a2 as xe,ay as Ie,az as _e,an as Se,aA as be,ap as he,v as S,aB as Ce,_ as T,Y as w,a3 as F,U as Be}from"./index-C-Wof5fh.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as Te}from"./product-8O1O2EAa.js";import{V as G,a as y,b as U}from"./route-block-CDH56o19.js";import{u as we,c as Fe,a as Ge,p as Ue,b as Ae,d as Oe,e as Le,f as Ee,g as Re,h as je,i as Ne,j as ze,m as We,k as Me,l as qe,n as $e,o as Ye,q as Ze,V as He,r as Je,s as Ke,t as Qe}from"./VPagination-Bn5wrU0a.js";import{V as Xe}from"./VContainer-Dvv4KtVd.js";import"./VList-CXA49yes.js";import"./ssrBoot-DksyFfg0.js";import"./VDivider-DMSXzlXu.js";const et=A({items:{type:Array,default:()=>[]},itemValue:{type:[String,Array,Function],default:"id"},itemSelectable:{type:[String,Array,Function],default:null},returnObject:Boolean},"DataIterator-items");function tt(e,s){const t=e.returnObject?s:B(s,e.itemValue),l=B(s,e.itemSelectable,!0);return{type:"item",value:t,selectable:l,raw:s}}function at(e,s){const t=[];for(const l of s)t.push(tt(e,l));return t}function rt(e){return{items:V(()=>at(e,e.items))}}const ot=A({search:String,loading:Boolean,...pe(),...et(),...Ze(),...Ye(),...$e({itemsPerPage:5}),...qe(),...Me(),...We(),...me(),...de({transition:{component:ge,hideOnLeave:!0}})},"VDataIterator"),st=re()({name:"VDataIterator",props:ot(),emits:{"update:modelValue":e=>!0,"update:groupBy":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:currentItems":e=>!0},setup(e,s){let{slots:t}=s;const l=oe(e,"groupBy"),p=D(()=>e.search),{items:d}=rt(e),{filteredItems:g}=we(e,d,p,{transform:v=>v.raw}),{initialSortOrder:m,sortBy:c,multiSort:u,mustSort:n}=Fe(e),{page:i,itemsPerPage:r}=Ge(e),{toggleSort:f}=ze({initialSortOrder:m,sortBy:c,multiSort:u,mustSort:n,page:i}),{sortByWithGroups:L,opened:E,extractRows:R,isGroupOpen:j,toggleGroup:N}=Ue({groupBy:l,sortBy:c}),{sortedItems:z}=Ae(e,g,L,{transform:v=>v.raw}),{flatItems:h}=Oe(z,l,E,!1),W=D(()=>h.value.length),{startIndex:M,stopIndex:q,pageCount:$,prevPage:Y,nextPage:Z,setItemsPerPage:H,setPage:J}=Le({page:i,itemsPerPage:r,itemsLength:W}),{paginatedItems:I}=Ee({items:h,startIndex:M,stopIndex:q,itemsPerPage:r}),C=V(()=>R(I.value)),{isSelected:K,select:Q,selectAll:X,toggleSelect:ee}=Re(e,{allItems:d,currentPage:C}),{isExpanded:te,toggleExpand:ae}=je(e);Ne({page:i,itemsPerPage:r,sortBy:c,groupBy:l,search:p});const _=V(()=>({page:i.value,itemsPerPage:r.value,sortBy:c.value,pageCount:$.value,toggleSort:f,prevPage:Y,nextPage:Z,setPage:J,setItemsPerPage:H,isSelected:K,select:Q,selectAll:X,toggleSelect:ee,isExpanded:te,toggleExpand:ae,isGroupOpen:j,toggleGroup:N,items:C.value,itemsCount:g.value.length,groupedItems:I.value}));return se(()=>a(e.tag,{class:ce(["v-data-iterator",{"v-data-iterator--loading":e.loading},e.class]),style:ie(e.style)},{default:()=>[t.header?.(_.value),a(ne,{transition:e.transition},{default:()=>[e.loading?a(ue,{key:"loader",name:"v-data-iterator",active:!0},{default:v=>t.loader?.(v)}):le("div",{key:"items"},[I.value.length?t.default?.(_.value):t["no-data"]?.()])]}),t.footer?.(_.value)]})),{}}}),nt={__name:"CardProduct",props:["id","imageUrl","name","category","price","description"],setup(e){const s=O(),t=fe(),l=ve(),p=e,d=V(()=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(p.price)),g=async()=>{try{if(!t.isLoggedIn){l.push("/login");return}const{data:m}=await he.cart({product:p.id,quantity:1,replace:!1});t.cart=m.result,s({text:"加入購物車成功",snackbarProps:{color:"green"}})}catch(m){const c=m?.response?.data?.message||"發生錯誤";s({text:c,snackbarProps:{color:"red"}})}};return(m,c)=>{const u=ye("router-link");return P(),b(be,null,{default:o(()=>[a(Pe,{class:"align-end text-white",cover:"",height:"200",src:e.imageUrl},null,8,["src"]),a(Ve,null,{default:o(()=>[a(u,{to:"/product/"+e.id},{default:o(()=>[k(x(e.name),1)]),_:1},8,["to"])]),_:1}),a(ke,null,{default:o(()=>[k(x(e.category)+" / "+x(xe(d)),1)]),_:1}),a(Ie,null,{default:o(()=>[k(x(e.description),1)]),_:1}),a(_e,null,{default:o(()=>[a(Se,{block:"",color:"primary","prepend-icon":"mdi-cart",variant:"outlined",onClick:g},{default:o(()=>[...c[0]||(c[0]=[k("加入購物車",-1)])]),_:1})]),_:1})]),_:1})}}},lt=De(nt,[["__scopeId","data-v-6253bcf4"]]),ut={__name:"index",setup(e){const s=O(),t=S({text:"",categories:[],sort:{text:"名稱",key:"name",direction:1}}),l=S([]),p=V(()=>l.value.filter(u=>{const n=u.name.toLowerCase().includes(t.value.text.toLowerCase()),i=t.value.categories.length===0||t.value.categories.includes(u.category);return n&&i}).toSorted((u,n)=>{const i=t.value.sort.direction,r=t.value.sort.key;return u[r]>n[r]?1*i:-1*i})),d=S(1),g=["手機","電腦","平板","玩具","食品","衣服","遊戲","書籍","其他"],m=[{text:"名稱",key:"name",direction:1},{text:"價格: 低到高",key:"price",direction:1},{text:"價格: 高到低",key:"price",direction:-1},{text:"新到舊",key:"createdAt",direction:-1},{text:"舊到新",key:"createdAt",direction:1}];return(async()=>{try{const{data:u}=await Te.get();l.value=u.result}catch{s({text:"發生錯誤",snackbarProps:{color:"red"}})}})(),(u,n)=>{const i=lt;return P(),b(Xe,null,{default:o(()=>[a(G,null,{default:o(()=>[a(y,{cols:"12"},{default:o(()=>[a(Ce,{modelValue:t.value.text,"onUpdate:modelValue":n[0]||(n[0]=r=>t.value.text=r),"hide-details":""},null,8,["modelValue"])]),_:1}),a(y,{cols:"12"},{default:o(()=>[a(He,{modelValue:t.value.categories,"onUpdate:modelValue":n[1]||(n[1]=r=>t.value.categories=r),multiple:"","selected-class":"text-primary"},{default:o(()=>[(P(),T(w,null,F(g,r=>a(Je,{key:r,filter:"",text:r,value:r},null,8,["text","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(y,{cols:"12"},{default:o(()=>[a(Ke,{modelValue:t.value.sort,"onUpdate:modelValue":n[2]||(n[2]=r=>t.value.sort=r),"hide-details":"","item-title":"text",items:m,"return-object":""},null,8,["modelValue"])]),_:1}),a(y,{cols:"12"},{default:o(()=>[a(st,{items:p.value,"items-per-page":12,page:d.value},{default:o(({items:r})=>[a(G,{class:"my-3"},{default:o(()=>[(P(!0),T(w,null,F(r,f=>(P(),b(y,{key:f._id,cols:"12",lg:"3",md:"6"},{default:o(()=>[a(i,Be({ref_for:!0},f.raw),null,16)]),_:2},1024))),128))]),_:2},1024)]),footer:o(({pageCount:r})=>[a(Qe,{modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=f=>d.value=f),length:r},null,8,["modelValue","length"])]),_:1},8,["items","page"])]),_:1})]),_:1})]),_:1})}}};typeof U=="function"&&U(ut);export{ut as default};
